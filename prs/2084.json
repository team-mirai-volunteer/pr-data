{
  "basic_info": {
    "number": 2084,
    "title": "Enhance Slack notifications for all PR closure scenarios",
    "state": "closed",
    "created_at": "2025-06-09T06:36:15Z",
    "updated_at": "2025-06-09T06:45:39Z",
    "closed_at": "2025-06-09T06:45:36Z",
    "merged_at": "2025-06-09T06:45:36Z",
    "html_url": "https://github.com/team-mirai/policy/pull/2084",
    "user": {
      "login": "devin-ai-integration[bot]",
      "id": 158243242,
      "html_url": "https://github.com/apps/devin-ai-integration"
    }
  },
  "labels": [],
  "comments": [
    {
      "url": "https://api.github.com/repos/team-mirai/policy/issues/comments/2954810409",
      "html_url": "https://github.com/team-mirai/policy/pull/2084#issuecomment-2954810409",
      "issue_url": "https://api.github.com/repos/team-mirai/policy/issues/2084",
      "id": 2954810409,
      "node_id": "IC_kwDOOqTJvM6wHtQp",
      "user": {
        "login": "devin-ai-integration[bot]",
        "id": 158243242,
        "node_id": "BOT_kgDOCW6Zqg",
        "avatar_url": "https://avatars.githubusercontent.com/in/811515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "followers_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "created_at": "2025-06-09T06:36:17Z",
      "updated_at": "2025-06-09T06:36:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "### ü§ñ Devin AI Engineer\n\nI'll be helping with this pull request! Here's what you should know:\n\n‚úÖ I will automatically:\n- Address comments on this PR. Add '(aside)' to your comment to have me ignore it.\n- Look at CI failures and help fix them\n\nNote: I can only respond to comments from users who have write access to this repository.\n\n‚öôÔ∏è Control Options:\n- [ ] Disable automatic comment and CI monitoring\n",
      "reactions": {
        "url": "https://api.github.com/repos/team-mirai/policy/issues/comments/2954810409/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "performed_via_github_app": {
        "id": 811515,
        "client_id": "Iv1.fffb955bc006997f",
        "slug": "devin-ai-integration",
        "node_id": "A_kwHOCQk3ds4ADGH7",
        "owner": {
          "login": "usacognition",
          "id": 151598966,
          "node_id": "O_kgDOCQk3dg",
          "avatar_url": "https://avatars.githubusercontent.com/u/151598966?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/usacognition",
          "html_url": "https://github.com/usacognition",
          "followers_url": "https://api.github.com/users/usacognition/followers",
          "following_url": "https://api.github.com/users/usacognition/following{/other_user}",
          "gists_url": "https://api.github.com/users/usacognition/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/usacognition/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/usacognition/subscriptions",
          "organizations_url": "https://api.github.com/users/usacognition/orgs",
          "repos_url": "https://api.github.com/users/usacognition/repos",
          "events_url": "https://api.github.com/users/usacognition/events{/privacy}",
          "received_events_url": "https://api.github.com/users/usacognition/received_events",
          "type": "Organization",
          "user_view_type": "public",
          "site_admin": false
        },
        "name": "Devin.ai Integration",
        "description": "This Github App integration allows Devin (devin.ai) to have limited authenticated access to your organization's code repositories.",
        "external_url": "https://devin.ai",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "created_at": "2024-01-31T03:16:04Z",
        "updated_at": "2025-05-14T06:48:07Z",
        "permissions": {
          "actions": "read",
          "checks": "read",
          "contents": "write",
          "deployments": "read",
          "discussions": "write",
          "emails": "read",
          "issues": "write",
          "members": "read",
          "metadata": "read",
          "packages": "read",
          "pages": "read",
          "pull_requests": "write",
          "repository_advisories": "read",
          "repository_hooks": "read",
          "repository_projects": "read",
          "statuses": "read",
          "vulnerability_alerts": "read",
          "workflows": "write"
        },
        "events": [
          "check_run",
          "issue_comment",
          "pull_request",
          "pull_request_review",
          "pull_request_review_comment",
          "repository",
          "status"
        ]
      }
    }
  ],
  "review_comments": [],
  "files": [
    {
      "sha": "085a79d9ca92322dc6cde98f9d1aed0d062c1af8",
      "filename": ".github/workflows/slack-notification-on-merge.yml",
      "status": "modified",
      "additions": 21,
      "deletions": 3,
      "changes": 24,
      "blob_url": "https://github.com/team-mirai/policy/blob/4580b4f3cf4c1ae809212d48e91fe2276fb27b82/.github%2Fworkflows%2Fslack-notification-on-merge.yml",
      "raw_url": "https://github.com/team-mirai/policy/raw/4580b4f3cf4c1ae809212d48e91fe2276fb27b82/.github%2Fworkflows%2Fslack-notification-on-merge.yml",
      "contents_url": "https://api.github.com/repos/team-mirai/policy/contents/.github%2Fworkflows%2Fslack-notification-on-merge.yml?ref=4580b4f3cf4c1ae809212d48e91fe2276fb27b82",
      "patch": "@@ -1,4 +1,4 @@\n-name: Slack Notification on PR Merge\n+name: Slack Notification on PR Close\n \n on:\n   pull_request:\n@@ -7,7 +7,6 @@ on:\n \n jobs:\n   notify-slack:\n-    if: github.event.pull_request.merged == true\n     runs-on: ubuntu-24.04\n     steps:\n       - name: Get PR labels and changed files\n@@ -18,15 +17,34 @@ jobs:\n             jq -r '.labels | map(.name) | join(\", \")')\n           echo \"labels=$labels\" >> $GITHUB_OUTPUT\n           \n+          has_thankyou=$(curl -s -H \"Authorization: token ${{ secrets.GITHUB_TOKEN }}\" \\\n+            \"https://api.github.com/repos/${{ github.repository }}/pulls/${{ github.event.pull_request.number }}\" | \\\n+            jq -r '.labels | map(.name) | contains([\"thankyou\"])')\n+          echo \"has_thankyou=$has_thankyou\" >> $GITHUB_OUTPUT\n+          \n           changed_files=$(curl -s -H \"Authorization: token ${{ secrets.GITHUB_TOKEN }}\" \\\n             \"https://api.github.com/repos/${{ github.repository }}/pulls/${{ github.event.pull_request.number }}/files\" | \\\n             jq -r '.[].filename | select(. != null)' | tr '\\n' ',' | sed 's/,$//')\n           echo \"changed_files=$changed_files\" >> $GITHUB_OUTPUT\n       \n+      - name: Determine notification message\n+        id: message-template\n+        run: |\n+          if [ \"${{ github.event.pull_request.merged }}\" == \"true\" ]; then\n+            echo \"message=ÊîøÁ≠ñÊèêÊ°à„Åå„Éû„Éã„Éï„Çß„Çπ„Éà„Å´Âèñ„ÇäËæº„Åæ„Çå„Åæ„Åó„Åü:tada:\" >> $GITHUB_OUTPUT\n+            echo \"handler=${{ github.event.pull_request.merged_by.login }}\" >> $GITHUB_OUTPUT\n+          elif [ \"${{ steps.get-pr-info.outputs.has_thankyou }}\" == \"true\" ]; then\n+            echo \"message=ÊîøÁ≠ñÊèêÊ°à„ÅåThank You‰ªò„Åç„Åß„ÇØ„É≠„Éº„Ç∫„Åï„Çå„Åæ„Åó„Åü:white_check_mark:\" >> $GITHUB_OUTPUT\n+            echo \"handler=${{ github.actor }}\" >> $GITHUB_OUTPUT\n+          else\n+            echo \"message=ÊîøÁ≠ñÊèêÊ°à„Åå„ÇØ„É≠„Éº„Ç∫„Åï„Çå„Åæ„Åó„Åü:octagonal_sign:\" >> $GITHUB_OUTPUT\n+            echo \"handler=${{ github.actor }}\" >> $GITHUB_OUTPUT\n+          fi\n+      \n       - name: Send Slack notification\n         run: |\n           curl -X POST -H 'Content-type: application/json' \\\n             --data \"{\n-              \\\"text\\\": \\\"ÊîøÁ≠ñÊèêÊ°à„Åå„Éû„Éã„Éï„Çß„Çπ„Éà„Å´Âèñ„ÇäËæº„Åæ„Çå„Åæ„Åó„Åü:tada:\\\\n\\\\n*<${{ github.event.pull_request.html_url }}|${{ github.event.pull_request.title }}>*\\\\n* ÊèêÊ°àËÄÖ: ${{ github.event.pull_request.user.login }}\\\\n* ÂØæÂøúËÄÖ: ${{ github.event.pull_request.merged_by.login }}\\\\n* Â§âÊõ¥„Éï„Ç°„Ç§„É´: ${{ steps.get-pr-info.outputs.changed_files }}\\\\n* „É©„Éô„É´: ${{ steps.get-pr-info.outputs.labels }}\\\"\n+              \\\"text\\\": \\\"${{ steps.message-template.outputs.message }}\\\\n\\\\n*<${{ github.event.pull_request.html_url }}|${{ github.event.pull_request.title }}>*\\\\n* ÊèêÊ°àËÄÖ: ${{ github.event.pull_request.user.login }}\\\\n* ÂØæÂøúËÄÖ: ${{ steps.message-template.outputs.handler }}\\\\n* Â§âÊõ¥„Éï„Ç°„Ç§„É´: ${{ steps.get-pr-info.outputs.changed_files }}\\\\n* „É©„Éô„É´: ${{ steps.get-pr-info.outputs.labels }}\\\"\n             }\" \\\n             ${{ secrets.SLACK_WEBHOOK_URL_01 }}"
    }
  ],
  "commits": [
    {
      "sha": "0ad6d393d96366086116422f448365cdbd97091a",
      "node_id": "C_kwDOOqTJvNoAKDBhZDZkMzkzZDk2MzY2MDg2MTE2NDIyZjQ0ODM2NWNkYmQ5NzA5MWE",
      "commit": {
        "author": {
          "name": "Devin AI",
          "email": "158243242+devin-ai-integration[bot]@users.noreply.github.com",
          "date": "2025-06-09T06:36:10Z"
        },
        "committer": {
          "name": "Devin AI",
          "email": "158243242+devin-ai-integration[bot]@users.noreply.github.com",
          "date": "2025-06-09T06:36:10Z"
        },
        "message": "Enhance Slack notifications for all PR closure scenarios\n\n- Add support for 3 different PR closure scenarios:\n  1. PR merged: success message with tada emoji\n  2. PR closed with thankyou label: thank you message with white_check_mark emoji\n  3. PR closed without thankyou label: closure message with octagonal_sign emoji\n- All scenarios include PR title in bold format with link\n- Include proposer, handler, changed files, and labels for all cases\n- Use github.actor for handler when PR is closed but not merged\n- Add thankyou label detection using jq contains() function\n\nCo-Authored-By: jujunjun110@gmail.com <jujunjun110@gmail.com>",
        "tree": {
          "sha": "f12ecb89c9deec700daaf7db75bb19923bf51149",
          "url": "https://api.github.com/repos/team-mirai/policy/git/trees/f12ecb89c9deec700daaf7db75bb19923bf51149"
        },
        "url": "https://api.github.com/repos/team-mirai/policy/git/commits/0ad6d393d96366086116422f448365cdbd97091a",
        "comment_count": 0,
        "verification": {
          "verified": false,
          "reason": "unsigned",
          "signature": null,
          "payload": null,
          "verified_at": null
        }
      },
      "url": "https://api.github.com/repos/team-mirai/policy/commits/0ad6d393d96366086116422f448365cdbd97091a",
      "html_url": "https://github.com/team-mirai/policy/commit/0ad6d393d96366086116422f448365cdbd97091a",
      "comments_url": "https://api.github.com/repos/team-mirai/policy/commits/0ad6d393d96366086116422f448365cdbd97091a/comments",
      "author": {
        "login": "devin-ai-integration[bot]",
        "id": 158243242,
        "node_id": "BOT_kgDOCW6Zqg",
        "avatar_url": "https://avatars.githubusercontent.com/in/811515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "followers_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "committer": {
        "login": "devin-ai-integration[bot]",
        "id": 158243242,
        "node_id": "BOT_kgDOCW6Zqg",
        "avatar_url": "https://avatars.githubusercontent.com/in/811515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "followers_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "parents": [
        {
          "sha": "0d0e475e8ef7088f17308affa77f7efd2e91389f",
          "url": "https://api.github.com/repos/team-mirai/policy/commits/0d0e475e8ef7088f17308affa77f7efd2e91389f",
          "html_url": "https://github.com/team-mirai/policy/commit/0d0e475e8ef7088f17308affa77f7efd2e91389f"
        }
      ]
    },
    {
      "sha": "4580b4f3cf4c1ae809212d48e91fe2276fb27b82",
      "node_id": "C_kwDOOqTJvNoAKDQ1ODBiNGYzY2Y0YzFhZTgwOTIxMmQ0OGU5MWZlMjI3NmZiMjdiODI",
      "commit": {
        "author": {
          "name": "Devin AI",
          "email": "158243242+devin-ai-integration[bot]@users.noreply.github.com",
          "date": "2025-06-09T06:44:07Z"
        },
        "committer": {
          "name": "Devin AI",
          "email": "158243242+devin-ai-integration[bot]@users.noreply.github.com",
          "date": "2025-06-09T06:44:07Z"
        },
        "message": "Refactor Slack notification workflow using DRY principles\n\n- Consolidate 3 separate notification steps into 1 unified step\n- Add message templating step to determine appropriate message and handler\n- Eliminate duplicate curl commands and JSON structure\n- Maintain same 3 message scenarios with conditional logic\n- Reduce code duplication while preserving functionality\n\nCo-Authored-By: jujunjun110@gmail.com <jujunjun110@gmail.com>",
        "tree": {
          "sha": "c088e500a9cbcf241bb56056403248529244c2b2",
          "url": "https://api.github.com/repos/team-mirai/policy/git/trees/c088e500a9cbcf241bb56056403248529244c2b2"
        },
        "url": "https://api.github.com/repos/team-mirai/policy/git/commits/4580b4f3cf4c1ae809212d48e91fe2276fb27b82",
        "comment_count": 0,
        "verification": {
          "verified": false,
          "reason": "unsigned",
          "signature": null,
          "payload": null,
          "verified_at": null
        }
      },
      "url": "https://api.github.com/repos/team-mirai/policy/commits/4580b4f3cf4c1ae809212d48e91fe2276fb27b82",
      "html_url": "https://github.com/team-mirai/policy/commit/4580b4f3cf4c1ae809212d48e91fe2276fb27b82",
      "comments_url": "https://api.github.com/repos/team-mirai/policy/commits/4580b4f3cf4c1ae809212d48e91fe2276fb27b82/comments",
      "author": {
        "login": "devin-ai-integration[bot]",
        "id": 158243242,
        "node_id": "BOT_kgDOCW6Zqg",
        "avatar_url": "https://avatars.githubusercontent.com/in/811515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "followers_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "committer": {
        "login": "devin-ai-integration[bot]",
        "id": 158243242,
        "node_id": "BOT_kgDOCW6Zqg",
        "avatar_url": "https://avatars.githubusercontent.com/in/811515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D",
        "html_url": "https://github.com/apps/devin-ai-integration",
        "followers_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}",
        "gists_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events",
        "type": "Bot",
        "user_view_type": "public",
        "site_admin": false
      },
      "parents": [
        {
          "sha": "0ad6d393d96366086116422f448365cdbd97091a",
          "url": "https://api.github.com/repos/team-mirai/policy/commits/0ad6d393d96366086116422f448365cdbd97091a",
          "html_url": "https://github.com/team-mirai/policy/commit/0ad6d393d96366086116422f448365cdbd97091a"
        }
      ]
    }
  ],
  "collected_at": "2025-06-10T03:23:36.809795"
}